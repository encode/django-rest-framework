[tox]
envlist =
       {py310}-{django42,django51,django52}
       {py311}-{django42,django51,django52}
       {py312}-{django42,django51,django52,django60,djangomain}
       {py313}-{django51,django52,django60,djangomain}
       {py314}-{django52,django60,djangomain}
       base
       dist
       docs

[testenv]
commands = python -W error::DeprecationWarning -W error::PendingDeprecationWarning runtests.py --coverage {posargs}
envdir = {toxworkdir}/venvs/{envname}
setenv =
       PYTHONDONTWRITEBYTECODE=1
       PYTHONWARNINGS=once
dependency_groups =
       test
       optional
deps =
       django42: Django>=4.2,<5.0
       django50: Django>=5.0,<5.1
       django51: Django>=5.1,<5.2
       django52: Django>=5.2,<6.0
       django60: Django>=6.0,<6.1
       djangomain: https://github.com/django/django/archive/main.tar.gz

[testenv:base]
; Ensure optional dependencies are not required
dependency_groups =
       test
deps =

[testenv:dist]
commands = python -W error::DeprecationWarning -W error::PendingDeprecationWarning runtests.py --no-pkgroot --staticfiles {posargs}
dependency_groups =
       test
       optional
deps =

[testenv:docs]
skip_install = true
commands =
       mkdocs build
dependency_groups =
       test
       docs
deps =

[testenv:py312-djangomain]
ignore_outcome = true

[testenv:py313-djangomain]
ignore_outcome = true

[testenv:py314-djangomain]
ignore_outcome = true
